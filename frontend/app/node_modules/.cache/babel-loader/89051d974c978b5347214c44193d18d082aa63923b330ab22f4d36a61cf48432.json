{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Routes,Route}from'react-router-dom';import axios from'axios';import'./App.css';import Navbar from'./components/Navbar';import Home from'./pages/Home';import Register from'./pages/Register';import Login from'./pages/Login';import{Toaster}from'react-hot-toast';import{UserContextProvider}from'../context/userContext';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";axios.defaults.baseURL='http://98.85.96.246:3000';axios.defaults.withCredentials=true;function App(){const[users,setUsers]=useState([]);const[videos,setVideos]=useState([]);const[watchlist,setWatchlist]=useState([]);const[selectedVideo,setSelectedVideo]=useState(null);const[loading,setLoading]=useState(false);const[isFetching,setIsFetching]=useState(false);// Fetch data from APIs\nuseEffect(()=>{const fetchData=async()=>{setIsFetching(true);try{console.log('Fetching users, videos, and watchlist data...');const usersResponse=await axios.get('/api/users');// Relative path\nsetUsers(usersResponse.data);const videosResponse=await axios.get('/api/videos');// Relative path\nsetVideos(videosResponse.data);const watchlistResponse=await axios.get('/api/watchlist');// Relative path\nsetWatchlist(watchlistResponse.data);console.log('Data fetched successfully');}catch(err){console.error('Failed to fetch data:',err);}finally{setIsFetching(false);}};fetchData();},[]);// Function to start streaming a video\nconst startStream=async videoId=>{const trimmedVideoId=videoId.trim();// Ensure no leading/trailing spaces\nconsole.log('Requesting video with ID:',trimmedVideoId);// Debugging log\nsetLoading(true);try{const response=await axios.get(\"/api/videos/\".concat(trimmedVideoId));// Relative path\nconst videoData=response.data;console.log('Video metadata received:',videoData);// Debugging log\nsetSelectedVideo({id:videoData._id,title:videoData.title,url:videoData.url// Use the S3 URL returned by the API\n});}catch(err){console.error('Failed to load video metadata:',err);// Check if the error is a 404\nif(err.response&&err.response.status===404){alert('Video not found. Please select another video.');}else{alert('Failed to load video. Please try again later.');}}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"App\",style:{backgroundColor:'black',color:'red',textAlign:'center'},children:isFetching?/*#__PURE__*/_jsx(\"p\",{children:\"Loading data...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(UserContextProvider,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(Toaster,{position:\"bottom-right\",toastOptions:{duration:2000}}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(Register,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})})]})]}),/*#__PURE__*/_jsx(\"h1\",{children:\"Users\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"users-list\",children:users.map(user=>/*#__PURE__*/_jsxs(\"li\",{children:[user.name,\" (\",user.email,\")\"]},user.id))}),/*#__PURE__*/_jsx(\"h1\",{children:\"Video Streaming Application\"}),selectedVideo?/*#__PURE__*/_jsxs(\"div\",{className:\"video-player\",style:{margin:'20px auto'},children:[/*#__PURE__*/_jsx(\"h2\",{children:selectedVideo.title}),/*#__PURE__*/_jsxs(\"video\",{controls:true,width:\"800\",height:\"450\",children:[/*#__PURE__*/_jsx(\"source\",{src:selectedVideo.url,type:\"video/mp4\"}),\"Your browser does not support the video tag.\"]})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Select a video to play\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"video-list\",style:{margin:'20px auto',padding:'10px'},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Available Videos\"}),videos.map(video=>/*#__PURE__*/_jsx(\"div\",{className:\"video-item\",style:{cursor:'pointer',margin:'10px',padding:'10px',border:'1px solid red',borderRadius:'5px',display:'inline-block',color:'white',backgroundColor:'black'},onClick:()=>startStream(video._id)// Fetch the stream URL and set the selected video\n,children:video.title},video._id))]}),loading&&/*#__PURE__*/_jsx(\"p\",{children:\"Loading video...\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Watchlist\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"watchlist\",children:watchlist.map(item=>/*#__PURE__*/_jsxs(\"li\",{children:[item.title,\" - Status: \",item.status]},item.id))})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Routes","Route","axios","Navbar","Home","Register","Login","Toaster","UserContextProvider","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","defaults","baseURL","withCredentials","App","users","setUsers","videos","setVideos","watchlist","setWatchlist","selectedVideo","setSelectedVideo","loading","setLoading","isFetching","setIsFetching","fetchData","console","log","usersResponse","get","data","videosResponse","watchlistResponse","err","error","startStream","videoId","trimmedVideoId","trim","response","concat","videoData","id","_id","title","url","status","alert","className","style","backgroundColor","color","textAlign","children","position","toastOptions","duration","path","element","map","user","name","email","margin","controls","width","height","src","type","padding","video","cursor","border","borderRadius","display","onClick","item"],"sources":["C:/Users/PC/VideoStreamingService/frontend/app/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {Routes, Route} from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport './App.css';\r\nimport Navbar from './components/Navbar';\r\nimport Home from './pages/Home';\r\nimport Register from './pages/Register';\r\nimport Login from './pages/Login';\r\nimport { Toaster } from 'react-hot-toast';\r\nimport { UserContextProvider } from '../context/userContext';\r\n\r\naxios.defaults.baseURL = 'http://98.85.96.246:3000'\r\naxios.defaults.withCredentials = true\r\n\r\nfunction App() {\r\n  const [users, setUsers] = useState([]);\r\n  const [videos, setVideos] = useState([]);\r\n  const [watchlist, setWatchlist] = useState([]);\r\n  const [selectedVideo, setSelectedVideo] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [isFetching, setIsFetching] = useState(false);\r\n\r\n  // Fetch data from APIs\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      setIsFetching(true);\r\n      try {\r\n        console.log('Fetching users, videos, and watchlist data...');\r\n        const usersResponse = await axios.get('/api/users'); // Relative path\r\n        setUsers(usersResponse.data);\r\n\r\n        const videosResponse = await axios.get('/api/videos'); // Relative path\r\n        setVideos(videosResponse.data);\r\n\r\n        const watchlistResponse = await axios.get('/api/watchlist'); // Relative path\r\n        setWatchlist(watchlistResponse.data);\r\n\r\n        console.log('Data fetched successfully');\r\n      } catch (err) {\r\n        console.error('Failed to fetch data:', err);\r\n      } finally {\r\n        setIsFetching(false);\r\n      }\r\n    };\r\n    fetchData();\r\n  }, []);\r\n\r\n  // Function to start streaming a video\r\n  const startStream = async (videoId) => {\r\n    const trimmedVideoId = videoId.trim(); // Ensure no leading/trailing spaces\r\n    console.log('Requesting video with ID:', trimmedVideoId); // Debugging log\r\n\r\n    setLoading(true);\r\n    try {\r\n      const response = await axios.get(`/api/videos/${trimmedVideoId}`); // Relative path\r\n      const videoData = response.data;\r\n\r\n      console.log('Video metadata received:', videoData); // Debugging log\r\n\r\n      setSelectedVideo({\r\n        id: videoData._id,\r\n        title: videoData.title,\r\n        url: videoData.url, // Use the S3 URL returned by the API\r\n      });\r\n    } catch (err) {\r\n      console.error('Failed to load video metadata:', err);\r\n\r\n      // Check if the error is a 404\r\n      if (err.response && err.response.status === 404) {\r\n        alert('Video not found. Please select another video.');\r\n      } else {\r\n        alert('Failed to load video. Please try again later.');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"App\" style={{ backgroundColor: 'black', color: 'red', textAlign: 'center' }}>\r\n      {isFetching ? (\r\n        <p>Loading data...</p>\r\n      ) : (\r\n        <>\r\n        <UserContextProvider>\r\n        <Navbar />\r\n        <Toaster position='bottom-right' toastOptions={{duration: 2000}} />\r\n        <Routes>\r\n          <Route path='/' element={<Home />} />\r\n          <Route path='/register' element={<Register />} />\r\n          <Route path='/login' element={<Login />} />\r\n        </Routes>\r\n        </UserContextProvider>\r\n          {/* Users Section */}\r\n          <h1>Users</h1>\r\n          <ul className=\"users-list\">\r\n            {users.map((user) => (\r\n              <li key={user.id}>\r\n                {user.name} ({user.email})\r\n              </li>\r\n            ))}\r\n          </ul>\r\n\r\n          {/* Video Streaming Section */}\r\n          <h1>Video Streaming Application</h1>\r\n          {selectedVideo ? (\r\n            <div className=\"video-player\" style={{ margin: '20px auto' }}>\r\n              <h2>{selectedVideo.title}</h2>\r\n              <video controls width=\"800\" height=\"450\">\r\n                <source src={selectedVideo.url} type=\"video/mp4\" />\r\n                Your browser does not support the video tag.\r\n              </video>\r\n            </div>\r\n          ) : (\r\n            <p>Select a video to play</p>\r\n          )}\r\n\r\n          {/* Video List */}\r\n          <div className=\"video-list\" style={{ margin: '20px auto', padding: '10px' }}>\r\n            <h3>Available Videos</h3>\r\n            {videos.map((video) => (\r\n              <div\r\n                key={video._id}\r\n                className=\"video-item\"\r\n                style={{\r\n                  cursor: 'pointer',\r\n                  margin: '10px',\r\n                  padding: '10px',\r\n                  border: '1px solid red',\r\n                  borderRadius: '5px',\r\n                  display: 'inline-block',\r\n                  color: 'white',\r\n                  backgroundColor: 'black',\r\n                }}\r\n                onClick={() => startStream(video._id)} // Fetch the stream URL and set the selected video\r\n              >\r\n                {video.title}\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* Loading Indicator */}\r\n          {loading && <p>Loading video...</p>}\r\n\r\n          {/* Watchlist Section */}\r\n          <h1>Watchlist</h1>\r\n          <ul className=\"watchlist\">\r\n            {watchlist.map((item) => (\r\n              <li key={item.id}>\r\n                {item.title} - Status: {item.status}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAAQC,MAAM,CAAEC,KAAK,KAAO,kBAAkB,CAC9C,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,WAAW,CAClB,MAAO,CAAAC,MAAM,KAAM,qBAAqB,CACxC,MAAO,CAAAC,IAAI,KAAM,cAAc,CAC/B,MAAO,CAAAC,QAAQ,KAAM,kBAAkB,CACvC,MAAO,CAAAC,KAAK,KAAM,eAAe,CACjC,OAASC,OAAO,KAAQ,iBAAiB,CACzC,OAASC,mBAAmB,KAAQ,wBAAwB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE7DZ,KAAK,CAACa,QAAQ,CAACC,OAAO,CAAG,0BAA0B,CACnDd,KAAK,CAACa,QAAQ,CAACE,eAAe,CAAG,IAAI,CAErC,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAGtB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACuB,MAAM,CAAEC,SAAS,CAAC,CAAGxB,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACyB,SAAS,CAAEC,YAAY,CAAC,CAAG1B,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAAC2B,aAAa,CAAEC,gBAAgB,CAAC,CAAG5B,QAAQ,CAAC,IAAI,CAAC,CACxD,KAAM,CAAC6B,OAAO,CAAEC,UAAU,CAAC,CAAG9B,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAC+B,UAAU,CAAEC,aAAa,CAAC,CAAGhC,QAAQ,CAAC,KAAK,CAAC,CAEnD;AACAC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAgC,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5BD,aAAa,CAAC,IAAI,CAAC,CACnB,GAAI,CACFE,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAC,CAC5D,KAAM,CAAAC,aAAa,CAAG,KAAM,CAAAhC,KAAK,CAACiC,GAAG,CAAC,YAAY,CAAC,CAAE;AACrDf,QAAQ,CAACc,aAAa,CAACE,IAAI,CAAC,CAE5B,KAAM,CAAAC,cAAc,CAAG,KAAM,CAAAnC,KAAK,CAACiC,GAAG,CAAC,aAAa,CAAC,CAAE;AACvDb,SAAS,CAACe,cAAc,CAACD,IAAI,CAAC,CAE9B,KAAM,CAAAE,iBAAiB,CAAG,KAAM,CAAApC,KAAK,CAACiC,GAAG,CAAC,gBAAgB,CAAC,CAAE;AAC7DX,YAAY,CAACc,iBAAiB,CAACF,IAAI,CAAC,CAEpCJ,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC,CAC1C,CAAE,MAAOM,GAAG,CAAE,CACZP,OAAO,CAACQ,KAAK,CAAC,uBAAuB,CAAED,GAAG,CAAC,CAC7C,CAAC,OAAS,CACRT,aAAa,CAAC,KAAK,CAAC,CACtB,CACF,CAAC,CACDC,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAAAU,WAAW,CAAG,KAAO,CAAAC,OAAO,EAAK,CACrC,KAAM,CAAAC,cAAc,CAAGD,OAAO,CAACE,IAAI,CAAC,CAAC,CAAE;AACvCZ,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAEU,cAAc,CAAC,CAAE;AAE1Df,UAAU,CAAC,IAAI,CAAC,CAChB,GAAI,CACF,KAAM,CAAAiB,QAAQ,CAAG,KAAM,CAAA3C,KAAK,CAACiC,GAAG,gBAAAW,MAAA,CAAgBH,cAAc,CAAE,CAAC,CAAE;AACnE,KAAM,CAAAI,SAAS,CAAGF,QAAQ,CAACT,IAAI,CAE/BJ,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAEc,SAAS,CAAC,CAAE;AAEpDrB,gBAAgB,CAAC,CACfsB,EAAE,CAAED,SAAS,CAACE,GAAG,CACjBC,KAAK,CAAEH,SAAS,CAACG,KAAK,CACtBC,GAAG,CAAEJ,SAAS,CAACI,GAAK;AACtB,CAAC,CAAC,CACJ,CAAE,MAAOZ,GAAG,CAAE,CACZP,OAAO,CAACQ,KAAK,CAAC,gCAAgC,CAAED,GAAG,CAAC,CAEpD;AACA,GAAIA,GAAG,CAACM,QAAQ,EAAIN,GAAG,CAACM,QAAQ,CAACO,MAAM,GAAK,GAAG,CAAE,CAC/CC,KAAK,CAAC,+CAA+C,CAAC,CACxD,CAAC,IAAM,CACLA,KAAK,CAAC,+CAA+C,CAAC,CACxD,CACF,CAAC,OAAS,CACRzB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,mBACElB,IAAA,QAAK4C,SAAS,CAAC,KAAK,CAACC,KAAK,CAAE,CAAEC,eAAe,CAAE,OAAO,CAAEC,KAAK,CAAE,KAAK,CAAEC,SAAS,CAAE,QAAS,CAAE,CAAAC,QAAA,CACzF9B,UAAU,cACTnB,IAAA,MAAAiD,QAAA,CAAG,iBAAe,CAAG,CAAC,cAEtB/C,KAAA,CAAAE,SAAA,EAAA6C,QAAA,eACA/C,KAAA,CAACJ,mBAAmB,EAAAmD,QAAA,eACpBjD,IAAA,CAACP,MAAM,GAAE,CAAC,cACVO,IAAA,CAACH,OAAO,EAACqD,QAAQ,CAAC,cAAc,CAACC,YAAY,CAAE,CAACC,QAAQ,CAAE,IAAI,CAAE,CAAE,CAAC,cACnElD,KAAA,CAACZ,MAAM,EAAA2D,QAAA,eACLjD,IAAA,CAACT,KAAK,EAAC8D,IAAI,CAAC,GAAG,CAACC,OAAO,cAAEtD,IAAA,CAACN,IAAI,GAAE,CAAE,CAAE,CAAC,cACrCM,IAAA,CAACT,KAAK,EAAC8D,IAAI,CAAC,WAAW,CAACC,OAAO,cAAEtD,IAAA,CAACL,QAAQ,GAAE,CAAE,CAAE,CAAC,cACjDK,IAAA,CAACT,KAAK,EAAC8D,IAAI,CAAC,QAAQ,CAACC,OAAO,cAAEtD,IAAA,CAACJ,KAAK,GAAE,CAAE,CAAE,CAAC,EACrC,CAAC,EACY,CAAC,cAEpBI,IAAA,OAAAiD,QAAA,CAAI,OAAK,CAAI,CAAC,cACdjD,IAAA,OAAI4C,SAAS,CAAC,YAAY,CAAAK,QAAA,CACvBxC,KAAK,CAAC8C,GAAG,CAAEC,IAAI,eACdtD,KAAA,OAAA+C,QAAA,EACGO,IAAI,CAACC,IAAI,CAAC,IAAE,CAACD,IAAI,CAACE,KAAK,CAAC,GAC3B,GAFSF,IAAI,CAAClB,EAEV,CACL,CAAC,CACA,CAAC,cAGLtC,IAAA,OAAAiD,QAAA,CAAI,6BAA2B,CAAI,CAAC,CACnClC,aAAa,cACZb,KAAA,QAAK0C,SAAS,CAAC,cAAc,CAACC,KAAK,CAAE,CAAEc,MAAM,CAAE,WAAY,CAAE,CAAAV,QAAA,eAC3DjD,IAAA,OAAAiD,QAAA,CAAKlC,aAAa,CAACyB,KAAK,CAAK,CAAC,cAC9BtC,KAAA,UAAO0D,QAAQ,MAACC,KAAK,CAAC,KAAK,CAACC,MAAM,CAAC,KAAK,CAAAb,QAAA,eACtCjD,IAAA,WAAQ+D,GAAG,CAAEhD,aAAa,CAAC0B,GAAI,CAACuB,IAAI,CAAC,WAAW,CAAE,CAAC,+CAErD,EAAO,CAAC,EACL,CAAC,cAENhE,IAAA,MAAAiD,QAAA,CAAG,wBAAsB,CAAG,CAC7B,cAGD/C,KAAA,QAAK0C,SAAS,CAAC,YAAY,CAACC,KAAK,CAAE,CAAEc,MAAM,CAAE,WAAW,CAAEM,OAAO,CAAE,MAAO,CAAE,CAAAhB,QAAA,eAC1EjD,IAAA,OAAAiD,QAAA,CAAI,kBAAgB,CAAI,CAAC,CACxBtC,MAAM,CAAC4C,GAAG,CAAEW,KAAK,eAChBlE,IAAA,QAEE4C,SAAS,CAAC,YAAY,CACtBC,KAAK,CAAE,CACLsB,MAAM,CAAE,SAAS,CACjBR,MAAM,CAAE,MAAM,CACdM,OAAO,CAAE,MAAM,CACfG,MAAM,CAAE,eAAe,CACvBC,YAAY,CAAE,KAAK,CACnBC,OAAO,CAAE,cAAc,CACvBvB,KAAK,CAAE,OAAO,CACdD,eAAe,CAAE,OACnB,CAAE,CACFyB,OAAO,CAAEA,CAAA,GAAMxC,WAAW,CAACmC,KAAK,CAAC3B,GAAG,CAAG;AAAA,CAAAU,QAAA,CAEtCiB,KAAK,CAAC1B,KAAK,EAdP0B,KAAK,CAAC3B,GAeR,CACN,CAAC,EACC,CAAC,CAGLtB,OAAO,eAAIjB,IAAA,MAAAiD,QAAA,CAAG,kBAAgB,CAAG,CAAC,cAGnCjD,IAAA,OAAAiD,QAAA,CAAI,WAAS,CAAI,CAAC,cAClBjD,IAAA,OAAI4C,SAAS,CAAC,WAAW,CAAAK,QAAA,CACtBpC,SAAS,CAAC0C,GAAG,CAAEiB,IAAI,eAClBtE,KAAA,OAAA+C,QAAA,EACGuB,IAAI,CAAChC,KAAK,CAAC,aAAW,CAACgC,IAAI,CAAC9B,MAAM,GAD5B8B,IAAI,CAAClC,EAEV,CACL,CAAC,CACA,CAAC,EACL,CACH,CACE,CAAC,CAEV,CAEA,cAAe,CAAA9B,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}